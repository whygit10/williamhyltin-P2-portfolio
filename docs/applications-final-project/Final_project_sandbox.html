<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Analysis Portfolio - Final Project Sandbox</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Data Analysis Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../aboutme.html"> 
<span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projects" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-projects">    
        <li>
    <a class="dropdown-item" href="../case-study-1/case-study-1-write-up.html">
 <span class="dropdown-text">Case Study 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../case-study-2/case-study-2-write-up.html">
 <span class="dropdown-text">Case Study 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../case-study-3/case-study-3-write-up.html">
 <span class="dropdown-text">Case Study 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../case-study-4/case-study-4-write-up.html">
 <span class="dropdown-text">Case Study 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../presentation-exercise/presentation-exercise.html">
 <span class="dropdown-text">Presentation Exercise</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tidytuesday-exercise/tidytuesday-exercise.html">
 <span class="dropdown-text">Tidy Tuesday Exercise</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../data-exercise/data-exercise.html">
 <span class="dropdown-text">Complex Data Exercise</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../cdcdata-exercise/cdcdata-exercise.html">
 <span class="dropdown-text">CDC Data Exercise</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../HYLTIN-PII-project/products/manuscript/Manuscript.html">
 <span class="dropdown-text">Crime in Austin, TX</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/whygit10/williamhyltin-P2-portfolio"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-layout-custom page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
<!-- main -->

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Final Project Sandbox</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages('DescTools', 'caret', 'broom')</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(MASS, randomForestSRC, tidyverse, e1071, here, readxl, skimr, corrplot, patchwork)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>rawdf <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">'applications-final-project'</span>, <span class="st">'online_shoppers_intention.csv'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="data-description" class="level1">
<h1>Data Description</h1>
<p><a href="https://archive.ics.uci.edu/dataset/468/online+shoppers+purchasing+intention+dataset">Data Source</a><br>
<strong>Data Dictionary</strong> The dataset consists of 10 numerical and 8 categorical attributes. The ‘Revenue’ attribute can be used as the class label.</p>
<p>“Administrative”, “Administrative Duration”, “Informational”, “Informational Duration”, “Product Related” and “Product Related Duration” represent the number of different types of pages visited by the visitor in that session and total time spent in each of these page categories. The values of these features are derived from the URL information of the pages visited by the user and updated in real time when a user takes an action, e.g.&nbsp;moving from one page to another. The “Bounce Rate”, “Exit Rate” and “Page Value” features represent the metrics measured by “Google Analytics” for each page in the e-commerce site. The value of “Bounce Rate” feature for a web page refers to the percentage of visitors who enter the site from that page and then leave (“bounce”) without triggering any other requests to the analytics server during that session. The value of “Exit Rate” feature for a specific web page is calculated as for all pageviews to the page, the percentage that were the last in the session. The “Page Value” feature represents the average value for a web page that a user visited before completing an e-commerce transaction. The “Special Day” feature indicates the closeness of the site visiting time to a specific special day (e.g.&nbsp;Mother’s Day, Valentine’s Day) in which the sessions are more likely to be finalized with transaction. The value of this attribute is determined by considering the dynamics of e-commerce such as the duration between the order date and delivery date. For example, for Valentine’s day, this value takes a nonzero value between February 2 and February 12, zero before and after this date unless it is close to another special day, and its maximum value of 1 on February 8. The dataset also includes operating system, browser, region, traffic type, visitor type as returning or new visitor, a Boolean value indicating whether the date of the visit is weekend, and month of the year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rawdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Administrative   Administrative_Duration Informational    
 Min.   : 0.000   Min.   :   0.00         Min.   : 0.0000  
 1st Qu.: 0.000   1st Qu.:   0.00         1st Qu.: 0.0000  
 Median : 1.000   Median :   7.50         Median : 0.0000  
 Mean   : 2.315   Mean   :  80.82         Mean   : 0.5036  
 3rd Qu.: 4.000   3rd Qu.:  93.26         3rd Qu.: 0.0000  
 Max.   :27.000   Max.   :3398.75         Max.   :24.0000  
 Informational_Duration ProductRelated   ProductRelated_Duration
 Min.   :   0.00        Min.   :  0.00   Min.   :    0.0        
 1st Qu.:   0.00        1st Qu.:  7.00   1st Qu.:  184.1        
 Median :   0.00        Median : 18.00   Median :  598.9        
 Mean   :  34.47        Mean   : 31.73   Mean   : 1194.8        
 3rd Qu.:   0.00        3rd Qu.: 38.00   3rd Qu.: 1464.2        
 Max.   :2549.38        Max.   :705.00   Max.   :63973.5        
  BounceRates         ExitRates         PageValues        SpecialDay     
 Min.   :0.000000   Min.   :0.00000   Min.   :  0.000   Min.   :0.00000  
 1st Qu.:0.000000   1st Qu.:0.01429   1st Qu.:  0.000   1st Qu.:0.00000  
 Median :0.003112   Median :0.02516   Median :  0.000   Median :0.00000  
 Mean   :0.022191   Mean   :0.04307   Mean   :  5.889   Mean   :0.06143  
 3rd Qu.:0.016813   3rd Qu.:0.05000   3rd Qu.:  0.000   3rd Qu.:0.00000  
 Max.   :0.200000   Max.   :0.20000   Max.   :361.764   Max.   :1.00000  
    Month           OperatingSystems    Browser           Region     
 Length:12330       Min.   :1.000    Min.   : 1.000   Min.   :1.000  
 Class :character   1st Qu.:2.000    1st Qu.: 2.000   1st Qu.:1.000  
 Mode  :character   Median :2.000    Median : 2.000   Median :3.000  
                    Mean   :2.124    Mean   : 2.357   Mean   :3.147  
                    3rd Qu.:3.000    3rd Qu.: 2.000   3rd Qu.:4.000  
                    Max.   :8.000    Max.   :13.000   Max.   :9.000  
  TrafficType    VisitorType         Weekend         Revenue       
 Min.   : 1.00   Length:12330       Mode :logical   Mode :logical  
 1st Qu.: 2.00   Class :character   FALSE:9462      FALSE:10422    
 Median : 2.00   Mode  :character   TRUE :2868      TRUE :1908     
 Mean   : 4.07                                                     
 3rd Qu.: 4.00                                                     
 Max.   :20.00                                                     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rawdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Administrative Administrative_Duration Informational Informational_Duration
1              0                       0             0                      0
2              0                       0             0                      0
3              0                       0             0                      0
4              0                       0             0                      0
5              0                       0             0                      0
6              0                       0             0                      0
  ProductRelated ProductRelated_Duration BounceRates ExitRates PageValues
1              1                0.000000  0.20000000 0.2000000          0
2              2               64.000000  0.00000000 0.1000000          0
3              1                0.000000  0.20000000 0.2000000          0
4              2                2.666667  0.05000000 0.1400000          0
5             10              627.500000  0.02000000 0.0500000          0
6             19              154.216667  0.01578947 0.0245614          0
  SpecialDay Month OperatingSystems Browser Region TrafficType
1          0   Feb                1       1      1           1
2          0   Feb                2       2      1           2
3          0   Feb                4       1      9           3
4          0   Feb                3       2      2           4
5          0   Feb                3       3      1           4
6          0   Feb                2       2      1           3
        VisitorType Weekend Revenue
1 Returning_Visitor   FALSE   FALSE
2 Returning_Visitor   FALSE   FALSE
3 Returning_Visitor   FALSE   FALSE
4 Returning_Visitor   FALSE   FALSE
5 Returning_Visitor    TRUE   FALSE
6 Returning_Visitor   FALSE   FALSE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(rawdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">rawdf</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">12330</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">logical</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Month</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">VisitorType</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: logical</strong></p>
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: left;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Weekend</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: left;">FAL: 9462, TRU: 2868</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revenue</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: left;">FAL: 10422, TRU: 1908</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 23%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Administrative</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.32</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">27.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Administrative_Duration</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">80.82</td>
<td style="text-align: right;">176.78</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">7.50</td>
<td style="text-align: right;">93.26</td>
<td style="text-align: right;">3398.75</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Informational</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">24.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Informational_Duration</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">34.47</td>
<td style="text-align: right;">140.75</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">2549.38</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ProductRelated</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">31.73</td>
<td style="text-align: right;">44.48</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7.00</td>
<td style="text-align: right;">18.00</td>
<td style="text-align: right;">38.00</td>
<td style="text-align: right;">705.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">ProductRelated_Duration</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1194.75</td>
<td style="text-align: right;">1913.67</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">184.14</td>
<td style="text-align: right;">598.94</td>
<td style="text-align: right;">1464.16</td>
<td style="text-align: right;">63973.52</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BounceRates</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">ExitRates</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PageValues</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5.89</td>
<td style="text-align: right;">18.57</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">361.76</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">SpecialDay</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OperatingSystems</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.12</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">8.00</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Browser</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.36</td>
<td style="text-align: right;">1.72</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">13.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Region</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">9.00</td>
<td style="text-align: left;">▇▅▁▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">TrafficType</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.07</td>
<td style="text-align: right;">4.03</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">20.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="data-cleaning" class="level1">
<h1>Data Cleaning</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>MnthOrder <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Jan'</span>, <span class="st">'Feb'</span>, <span class="st">'Mar'</span>, <span class="st">'Apr'</span>, <span class="st">'May'</span>, <span class="st">'June'</span>, <span class="st">'Jul'</span>, <span class="st">'Aug'</span>, <span class="st">'Sep'</span>, <span class="st">'Oct'</span>, <span class="st">'Nov'</span>, <span class="st">'Dec'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> rawdf <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(OperatingSystems, Browser, Region, TrafficType, VisitorType), as.factor</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">fct_relevel</span>(Month, MnthOrder),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Revenue =</span> <span class="fu">ifelse</span>(Revenue <span class="sc">==</span> <span class="cn">TRUE</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Revenue =</span> <span class="fu">as.factor</span>(Revenue)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `Month = fct_relevel(Month, MnthOrder)`.
Caused by warning:
! 2 unknown levels in `f`: Jan and Apr</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">df1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">12330</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">factor</td>
<td style="text-align: left;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">logical</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 42%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">ordered</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: left;">top_counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Month</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">May: 3364, Nov: 2998, Mar: 1907, Dec: 1727</td>
</tr>
<tr class="even">
<td style="text-align: left;">OperatingSystems</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">2: 6601, 1: 2585, 3: 2555, 4: 478</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Browser</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">2: 7961, 1: 2462, 4: 736, 5: 467</td>
</tr>
<tr class="even">
<td style="text-align: left;">Region</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">1: 4780, 3: 2403, 4: 1182, 2: 1136</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TrafficType</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">2: 3913, 1: 2451, 3: 2052, 4: 1069</td>
</tr>
<tr class="even">
<td style="text-align: left;">VisitorType</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Ret: 10551, New: 1694, Oth: 85</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Revenue</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">0: 10422, 1: 1908</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: logical</strong></p>
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: left;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Weekend</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: left;">FAL: 9462, TRU: 2868</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 23%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Administrative</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.32</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">27.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Administrative_Duration</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">80.82</td>
<td style="text-align: right;">176.78</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">7.50</td>
<td style="text-align: right;">93.26</td>
<td style="text-align: right;">3398.75</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Informational</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">24.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Informational_Duration</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">34.47</td>
<td style="text-align: right;">140.75</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">2549.38</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ProductRelated</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">31.73</td>
<td style="text-align: right;">44.48</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7.00</td>
<td style="text-align: right;">18.00</td>
<td style="text-align: right;">38.00</td>
<td style="text-align: right;">705.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">ProductRelated_Duration</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1194.75</td>
<td style="text-align: right;">1913.67</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">184.14</td>
<td style="text-align: right;">598.94</td>
<td style="text-align: right;">1464.16</td>
<td style="text-align: right;">63973.52</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BounceRates</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">ExitRates</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PageValues</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5.89</td>
<td style="text-align: right;">18.57</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">361.76</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">SpecialDay</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(<span class="fu">select_if</span>(df1, <span class="fu">negate</span>(is.numeric)))){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">unique</span>(df1[[i]]))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Month"
 [1] Feb  Mar  May  Oct  June Jul  Aug  Nov  Sep  Dec 
Levels: Feb Mar May June Jul Aug Sep Oct Nov Dec
[1] "OperatingSystems"
[1] 1 2 4 3 7 6 8 5
Levels: 1 2 3 4 5 6 7 8
[1] "Browser"
 [1] 1  2  3  4  5  6  7  10 8  9  12 13 11
Levels: 1 2 3 4 5 6 7 8 9 10 11 12 13
[1] "Region"
[1] 1 9 2 3 4 5 6 7 8
Levels: 1 2 3 4 5 6 7 8 9
[1] "TrafficType"
 [1] 1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 18 19 16 17 20
Levels: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20
[1] "VisitorType"
[1] Returning_Visitor New_Visitor       Other            
Levels: New_Visitor Other Returning_Visitor
[1] "Weekend"
[1] FALSE  TRUE
[1] "Revenue"
[1] 0 1
Levels: 0 1</code></pre>
</div>
</div>
<p>Traffic type causes some problems with a few factors being very infrequent, so I will collapse them here to make it easier for test and training splits.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">TrafficType =</span> <span class="fu">fct_lump_lowfreq</span>(TrafficType)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-exploration" class="level1">
<h1>Data Exploration</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>barplots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">colnames</span>(<span class="fu">select_if</span>(df1, <span class="fu">negate</span>(is.numeric))),</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>       <span class="cf">function</span>(col) {</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">select_if</span>(df1, <span class="fu">negate</span>(is.character)),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">y =</span> df1[[col]], <span class="at">fill =</span> df1<span class="sc">$</span>Revenue)) <span class="sc">+</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ggtitle</span>(col) <span class="sc">+</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ylab</span>(col) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">xlab</span>(<span class="st">'Count'</span>) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'top'</span>, <span class="at">legend.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">'Revenue'</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>barplots[[<span class="dv">1</span>]] <span class="sc">+</span> barplots[[<span class="dv">2</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>barplots[[<span class="dv">3</span>]] <span class="sc">+</span> barplots[[<span class="dv">4</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.
Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>barplots[[<span class="dv">5</span>]] <span class="sc">+</span> barplots[[<span class="dv">6</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.
Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>barplots[[<span class="dv">7</span>]] <span class="sc">+</span> barplots[[<span class="dv">8</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.
Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Transaction =</span> <span class="fu">ifelse</span>(Revenue <span class="sc">==</span> <span class="st">'1'</span>, <span class="st">'Yes'</span>, <span class="st">'No'</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> Transaction)) <span class="sc">+</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Transaction Performed'</span>) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Frequency'</span>) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Number of User Sessions that End in a Revenue Transaction'</span>, </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'User sessions do not typically end in a revenue transaction, </span><span class="sc">\n</span><span class="st">resulting in class imabalance for our response variable.'</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>dfMonths <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Month, Revenue) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Month =</span> <span class="fu">fct_relevel</span>(MnthOrder, MnthOrder)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(dfMonths, <span class="at">by =</span> <span class="fu">join_by</span>(Month)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Month, <span class="at">y=</span> Count, <span class="at">fill =</span> Revenue)) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Number of User Sessions by Month'</span>, </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'The number of user sessions varies by month, </span><span class="sc">\n</span><span class="st">with January and April completely unrepresented.'</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">na.translate =</span> F) <span class="sc">+</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_col()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>boxplots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">colnames</span>(<span class="fu">select_if</span>(df1, is.numeric)),</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>       <span class="cf">function</span>(col) {</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">select_if</span>(df1, <span class="fu">negate</span>(is.character)),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">y =</span> df1[[col]], <span class="at">x =</span> df1<span class="sc">$</span>Revenue)) <span class="sc">+</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ggtitle</span>(col) <span class="sc">+</span> </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ylab</span>(col) <span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">xlab</span>(<span class="st">'Revenue'</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>boxplots[[<span class="dv">1</span>]] <span class="sc">+</span> boxplots[[<span class="dv">2</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>boxplots[[<span class="dv">3</span>]] <span class="sc">+</span> boxplots[[<span class="dv">4</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.
Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>boxplots[[<span class="dv">5</span>]] <span class="sc">+</span> boxplots[[<span class="dv">6</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.
Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>boxplots[[<span class="dv">7</span>]] <span class="sc">+</span> boxplots[[<span class="dv">8</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.
Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>boxplots[[<span class="dv">9</span>]] <span class="sc">+</span> boxplots[[<span class="dv">10</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.
Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1$Revenue` is discouraged.
ℹ Use `Revenue` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `df1[[col]]` is discouraged.
ℹ Use `.data[[col]]` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-12-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">as.factor</span>(SpecialDay), <span class="at">fill =</span> Revenue)) <span class="sc">+</span><span class="co">#, x = Count)) +</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Number of Sessions by </span><span class="sc">\"</span><span class="st">Special Day</span><span class="sc">\"</span><span class="st"> Value'</span>, </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'The Special Day variable is primarily composed of 0 values'</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Special Day Value'</span>) <span class="sc">+</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Count'</span>) <span class="sc">+</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SpecialDay <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">as.factor</span>(SpecialDay), <span class="at">fill =</span> Revenue)) <span class="sc">+</span><span class="co">#, x = Count)) +</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Number of Sessions by </span><span class="sc">\"</span><span class="st">Special Day</span><span class="sc">\"</span><span class="st"> Value'</span>, </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">'Non-zero values may have a different distribution,</span><span class="sc">\n</span><span class="st">but are dwarfed by the zero values'</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Special Day Value'</span>) <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Count'</span>) <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Transformation to handle skewness?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span> <span class="fu">cor</span>() <span class="sc">%&gt;%</span> <span class="fu">corrplot</span>(<span class="at">method =</span> <span class="st">'number'</span>, <span class="at">type =</span> <span class="st">'lower'</span>, <span class="at">tl.cex =</span> .<span class="dv">75</span>, <span class="at">number.cex =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>BounceRates and ExitRates highly correlated. Exit rates looks like it has greater separation between our response variable classes than BounceRates does based on boxplots. ProductRelated and ProductRelated_Duration Highly correlated other duration variables are also pretty correlated, but not so much to immediately filter out.</p>
<p>I’m a little concerned about the variable PageValues. It may be too closely associated with our target variable, and could result in perfect separation, or issues with identifying variable importance or effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#df2 %&gt;% mutate(PageFactor = as.factor(ifelse(PageValues &gt; 0, 1, 0))) %&gt;% </span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  group_by(PageFactor, Revenue) %&gt;% </span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  summarize(n = n())</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a> df2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">PV_ind =</span> <span class="fu">ifelse</span>(PageValues <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(PV_ind) <span class="sc">%&gt;%</span> </span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarize</span>(</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">Rev =</span> <span class="fu">sum</span>(<span class="fu">ifelse</span>(Revenue <span class="sc">==</span> <span class="st">'0'</span>, <span class="dv">0</span>, <span class="dv">1</span>)), </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">NonRev=</span><span class="fu">n</span>() <span class="sc">-</span> Rev</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  PV_ind   Rev NonRev
   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1      0   370   9230
2      1  1538   1192</code></pre>
</div>
</div>
</section>
<section id="statistical-testing" class="level1">
<h1>Statistical Testing</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">24601</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>testsub <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(df2),<span class="dv">12330</span>,<span class="at">replace =</span> F)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>testsamps <span class="ot">&lt;-</span> df2[testsub,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(<span class="fu">select_if</span>(<span class="fu">select</span>(testsamps, <span class="sc">-</span>Revenue), <span class="fu">negate</span>(is.numeric)))){</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(testsamps[[i]], testsamps<span class="sc">$</span>Revenue))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">chisq.test</span>(testsamps[[i]], testsamps<span class="sc">$</span>Revenue))</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Month"
      
          0    1
  Feb   181    3
  Mar  1715  192
  May  2999  365
  June  259   29
  Jul   366   66
  Aug   357   76
  Sep   362   86
  Oct   434  115
  Nov  2238  760
  Dec  1511  216

    Pearson's Chi-squared test

data:  testsamps[[i]] and testsamps$Revenue
X-squared = 384.93, df = 9, p-value &lt; 2.2e-16

[1] "OperatingSystems"
   
       0    1
  1 2206  379
  2 5446 1155
  3 2287  268
  4  393   85
  5    5    1
  6   17    2
  7    6    1
  8   62   17</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(testsamps[[i]], testsamps$Revenue): Chi-squared
approximation may be incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  testsamps[[i]] and testsamps$Revenue
X-squared = 75.027, df = 7, p-value = 1.416e-13

[1] "Browser"
    
        0    1
  1  2097  365
  2  6738 1223
  3   100    5
  4   606  130
  5   381   86
  6   154   20
  7    43    6
  8   114   21
  9     1    0
  10  131   32
  11    5    1
  12    7    3
  13   45   16</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(testsamps[[i]], testsamps$Revenue): Chi-squared
approximation may be incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  testsamps[[i]] and testsamps$Revenue
X-squared = 27.715, df = 12, p-value = 0.006088

[1] "Region"
   
       0    1
  1 4009  771
  2  948  188
  3 2054  349
  4 1007  175
  5  266   52
  6  693  112
  7  642  119
  8  378   56
  9  425   86

    Pearson's Chi-squared test

data:  testsamps[[i]] and testsamps$Revenue
X-squared = 9.2528, df = 8, p-value = 0.3214

[1] "TrafficType"
       
           0    1
  1     2189  262
  2     3066  847
  3     1872  180
  4      904  165
  5      204   56
  6      391   53
  8      248   95
  10     360   90
  11     200   47
  13     695   43
  20     148   50
  Other  145   20

    Pearson's Chi-squared test

data:  testsamps[[i]] and testsamps$Revenue
X-squared = 355.89, df = 11, p-value &lt; 2.2e-16

[1] "VisitorType"
                   
                       0    1
  New_Visitor       1272  422
  Other               69   16
  Returning_Visitor 9081 1470

    Pearson's Chi-squared test

data:  testsamps[[i]] and testsamps$Revenue
X-squared = 135.25, df = 2, p-value &lt; 2.2e-16

[1] "Weekend"
       
           0    1
  FALSE 8053 1409
  TRUE  2369  499

    Pearson's Chi-squared test with Yates' continuity correction

data:  testsamps[[i]] and testsamps$Revenue
X-squared = 10.391, df = 1, p-value = 0.001266</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>testsamps_pos <span class="ot">&lt;-</span> testsamps <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Revenue <span class="sc">==</span> <span class="st">'1'</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>testsamps_neg <span class="ot">&lt;-</span> testsamps <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Revenue <span class="sc">==</span> <span class="st">'0'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Non-Normal distributions, T-test is not valid:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(<span class="fu">select_if</span>(testsamps, is.numeric))){</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">t.test</span>(testsamps_neg[[i]], testsamps_pos[[i]]))</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Administrative"

    Welch Two Sample t-test

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
t = -14.023, df = 2448.1, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -1.454287 -1.097462
sample estimates:
mean of x mean of y 
 2.117732  3.393606 

[1] "Administrative_Duration"

    Welch Two Sample t-test

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
t = -9.3363, df = 2437.5, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -55.35073 -36.13554
sample estimates:
mean of x mean of y 
 73.74011 119.48324 

[1] "Informational"

    Welch Two Sample t-test

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
t = -9.0871, df = 2369.8, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.4064780 -0.2621837
sample estimates:
mean of x mean of y 
0.4518327 0.7861635 

[1] "Informational_Duration"

    Welch Two Sample t-test

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
t = -6.609, df = 2350.5, p-value = 4.772e-11
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -35.49779 -19.25259
sample estimates:
mean of x mean of y 
 30.23624  57.61143 

[1] "ProductRelated"

    Welch Two Sample t-test

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
t = -14.002, df = 2260.4, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -22.22598 -16.76507
sample estimates:
mean of x mean of y 
 28.71464  48.21017 

[1] "ProductRelated_Duration"

    Welch Two Sample t-test

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
t = -14.447, df = 2350.3, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -915.6550 -696.7886
sample estimates:
mean of x mean of y 
 1069.988  1876.210 

[1] "BounceRates"

    Welch Two Sample t-test

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
t = 34.846, df = 11795, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.01906379 0.02133637
sample estimates:
  mean of x   mean of y 
0.025317232 0.005117153 

[1] "ExitRates"

    Welch Two Sample t-test

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
t = 44.332, df = 9308.3, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.02659286 0.02905335
sample estimates:
 mean of x  mean of y 
0.04737827 0.01955517 

[1] "PageValues"

    Welch Two Sample t-test

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
t = -31.199, df = 1953.6, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -26.87816 -23.69888
sample estimates:
mean of x mean of y 
 1.975998 27.264518 

[1] "SpecialDay"

    Welch Two Sample t-test

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
t = 12.965, df = 4219.1, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.03842153 0.05211156
sample estimates:
 mean of x  mean of y 
0.06843216 0.02316562 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(<span class="fu">select_if</span>(testsamps, is.numeric))){</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">wilcox.test</span>(testsamps_neg[[i]], testsamps_pos[[i]]))</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Administrative"

    Wilcoxon rank sum test with continuity correction

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
W = 7421136, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0

[1] "Administrative_Duration"

    Wilcoxon rank sum test with continuity correction

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
W = 7487115, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0

[1] "Informational"

    Wilcoxon rank sum test with continuity correction

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
W = 8648742, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0

[1] "Informational_Duration"

    Wilcoxon rank sum test with continuity correction

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
W = 8711649, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0

[1] "ProductRelated"

    Wilcoxon rank sum test with continuity correction

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
W = 6792127, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0

[1] "ProductRelated_Duration"

    Wilcoxon rank sum test with continuity correction

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
W = 6502463, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0

[1] "BounceRates"

    Wilcoxon rank sum test with continuity correction

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
W = 12198493, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0

[1] "ExitRates"

    Wilcoxon rank sum test with continuity correction

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
W = 13981307, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0

[1] "PageValues"

    Wilcoxon rank sum test with continuity correction

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
W = 2718419, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0

[1] "SpecialDay"

    Wilcoxon rank sum test with continuity correction

data:  testsamps_neg[[i]] and testsamps_pos[[i]]
W = 10665043, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>numvars <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">select_if</span>(testsamps, is.numeric))</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glm</span>(Revenue <span class="sc">~</span> ., <span class="at">data =</span> testsamps[<span class="fu">which</span>(<span class="fu">names</span>(testsamps) <span class="sc">%in%</span> numvars <span class="sc">|</span> <span class="fu">names</span>(testsamps)<span class="sc">==</span><span class="st">'Revenue'</span>)], <span class="at">family =</span> binomial))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Revenue ~ ., family = binomial, data = testsamps[which(names(testsamps) %in% 
    numvars | names(testsamps) == "Revenue")])

Coefficients:
                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             -2.027e+00  7.060e-02 -28.713  &lt; 2e-16 ***
Administrative           3.915e-03  1.087e-02   0.360  0.71862    
Administrative_Duration -1.470e-04  1.946e-04  -0.755  0.45006    
Informational            2.444e-02  2.648e-02   0.923  0.35602    
Informational_Duration   4.691e-05  2.212e-04   0.212  0.83206    
ProductRelated           3.259e-03  1.135e-03   2.871  0.00409 ** 
ProductRelated_Duration  5.643e-05  2.742e-05   2.058  0.03961 *  
BounceRates             -3.071e+00  3.196e+00  -0.961  0.33661    
ExitRates               -1.681e+01  2.335e+00  -7.197 6.14e-13 ***
PageValues               7.964e-02  2.329e-03  34.199  &lt; 2e-16 ***
SpecialDay              -9.303e-01  2.166e-01  -4.296 1.74e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 10624.8  on 12329  degrees of freedom
Residual deviance:  7419.7  on 12319  degrees of freedom
AIC: 7441.7

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>logit_test <span class="ot">&lt;-</span> <span class="fu">glm</span>(Revenue <span class="sc">~</span> ., <span class="at">data =</span> testsamps, <span class="at">family =</span> binomial)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_test) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Revenue ~ ., family = binomial, data = testsamps)

Coefficients: (1 not defined because of singularities)
                               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                  -3.562e+00  6.406e-01  -5.560 2.69e-08 ***
Administrative                3.375e-03  1.107e-02   0.305 0.760526    
Administrative_Duration      -1.019e-04  1.947e-04  -0.523 0.600748    
Informational                 3.175e-02  2.712e-02   1.171 0.241761    
Informational_Duration        4.294e-05  2.230e-04   0.193 0.847334    
ProductRelated                1.863e-03  1.166e-03   1.598 0.110008    
ProductRelated_Duration       5.909e-05  2.727e-05   2.167 0.030239 *  
BounceRates                  -1.684e+00  3.220e+00  -0.523 0.601057    
ExitRates                    -1.538e+01  2.443e+00  -6.295 3.08e-10 ***
PageValues                    8.194e-02  2.436e-03  33.637  &lt; 2e-16 ***
SpecialDay                   -9.505e-02  2.369e-01  -0.401 0.688311    
MonthMar                      1.128e+00  6.310e-01   1.788 0.073846 .  
MonthMay                      1.164e+00  6.252e-01   1.862 0.062570 .  
MonthJune                     1.379e+00  6.646e-01   2.075 0.037941 *  
MonthJul                      1.806e+00  6.430e-01   2.809 0.004971 ** 
MonthAug                      1.705e+00  6.429e-01   2.652 0.008007 ** 
MonthSep                      1.722e+00  6.410e-01   2.686 0.007229 ** 
MonthOct                      1.650e+00  6.379e-01   2.587 0.009695 ** 
MonthNov                      2.167e+00  6.268e-01   3.458 0.000544 ***
MonthDec                      9.976e-01  6.320e-01   1.578 0.114452    
OperatingSystems2             1.628e-01  1.650e-01   0.987 0.323845    
OperatingSystems3            -3.929e-02  1.772e-01  -0.222 0.824561    
OperatingSystems4            -3.307e-02  1.806e-01  -0.183 0.854687    
OperatingSystems5            -1.379e-02  1.210e+00  -0.011 0.990909    
OperatingSystems6            -1.024e+00  9.464e-01  -1.082 0.279084    
OperatingSystems7             1.173e+00  1.143e+00   1.026 0.304862    
OperatingSystems8             3.072e-01  6.411e-01   0.479 0.631849    
Browser2                     -1.197e-01  1.656e-01  -0.723 0.469816    
Browser3                     -1.010e+00  5.705e-01  -1.771 0.076639 .  
Browser4                     -5.288e-02  2.090e-01  -0.253 0.800212    
Browser5                      8.617e-02  2.246e-01   0.384 0.701277    
Browser6                     -4.018e-01  3.345e-01  -1.201 0.229720    
Browser7                     -9.564e-02  5.066e-01  -0.189 0.850268    
Browser8                      1.860e-01  3.178e-01   0.585 0.558471    
Browser9                     -8.051e+00  1.970e+02  -0.041 0.967396    
Browser10                     1.314e-01  2.951e-01   0.445 0.656206    
Browser11                            NA         NA      NA       NA    
Browser12                     1.793e+00  7.818e-01   2.294 0.021793 *  
Browser13                     8.826e-02  9.892e-01   0.089 0.928900    
Region2                       1.543e-01  1.116e-01   1.383 0.166740    
Region3                      -9.644e-03  8.657e-02  -0.111 0.911299    
Region4                      -5.258e-02  1.146e-01  -0.459 0.646345    
Region5                      -2.298e-01  2.118e-01  -1.085 0.277941    
Region6                       5.178e-02  1.336e-01   0.387 0.698394    
Region7                      -9.177e-03  1.355e-01  -0.068 0.946006    
Region8                       6.604e-02  1.749e-01   0.378 0.705727    
Region9                      -2.681e-01  1.737e-01  -1.543 0.122811    
TrafficType2                  1.839e-01  9.534e-02   1.929 0.053716 .  
TrafficType3                 -2.293e-01  1.244e-01  -1.844 0.065225 .  
TrafficType4                  5.172e-02  1.408e-01   0.367 0.713365    
TrafficType5                  2.516e-01  2.147e-01   1.172 0.241341    
TrafficType6                 -8.163e-02  1.986e-01  -0.411 0.681106    
TrafficType8                  6.126e-01  1.798e-01   3.408 0.000655 ***
TrafficType10                 3.822e-01  1.666e-01   2.293 0.021833 *  
TrafficType11                 4.177e-01  2.200e-01   1.899 0.057621 .  
TrafficType13                -5.253e-01  2.008e-01  -2.616 0.008890 ** 
TrafficType20                 4.806e-01  2.718e-01   1.768 0.077005 .  
TrafficTypeOther             -1.040e-01  3.338e-01  -0.312 0.755245    
VisitorTypeOther             -6.563e-01  7.588e-01  -0.865 0.387054    
VisitorTypeReturning_Visitor -2.099e-01  9.111e-02  -2.303 0.021254 *  
WeekendTRUE                   8.512e-02  7.236e-02   1.176 0.239486    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 10624.8  on 12329  degrees of freedom
Residual deviance:  7086.1  on 12270  degrees of freedom
AIC: 7206.1

Number of Fisher Scoring iterations: 10</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>logtestdf <span class="ot">&lt;-</span> testsamps <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">probabilities =</span> <span class="fu">predict</span>(logit_test, <span class="at">type =</span> <span class="st">'response'</span>),</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">logit =</span> <span class="fu">log</span>(probabilities<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>probabilities))</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>logit_scatter_test <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">colnames</span>(<span class="fu">select_if</span>(logtestdf, is.numeric)),</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>       <span class="cf">function</span>(col) {</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(logtestdf,</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> .data<span class="sc">$</span>logit, <span class="at">y =</span> .data[[col]])) <span class="sc">+</span> </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'loess'</span>) <span class="sc">+</span> </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ggtitle</span>(col)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>logit_scatter_test[[<span class="dv">1</span>]] <span class="sc">+</span> logit_scatter_test[[<span class="dv">2</span>]] <span class="sc">+</span> logit_scatter_test[[<span class="dv">3</span>]] <span class="sc">+</span> logit_scatter_test[[<span class="dv">4</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>logit_scatter_test[[<span class="dv">5</span>]] <span class="sc">+</span> logit_scatter_test[[<span class="dv">6</span>]] <span class="sc">+</span> logit_scatter_test[[<span class="dv">7</span>]] <span class="sc">+</span> logit_scatter_test[[<span class="dv">8</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>logit_scatter_test[[<span class="dv">9</span>]] <span class="sc">+</span> logit_scatter_test[[<span class="dv">10</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-25-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-preparation-and-splits" class="level1">
<h1>Data Preparation and Splits</h1>
<section id="unbalanced-split" class="level2">
<h2 data-anchor-id="unbalanced-split">Unbalanced Split</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making test and train sets</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">24601</span>) </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>unbal_part <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(df2),<span class="fl">0.8</span><span class="sc">*</span><span class="fu">nrow</span>(df2),<span class="at">replace =</span> F)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>unbal_train <span class="ot">&lt;-</span> df2[unbal_part,]</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>unbal_test <span class="ot">&lt;-</span> df2[<span class="sc">-</span>unbal_part,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="standardizing-numeric-variables" class="level2">
<h2 data-anchor-id="standardizing-numeric-variables">Standardizing Numeric Variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>num_means <span class="ot">&lt;-</span> unbal_train <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span> <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span> <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co"># rownames(num_means) &lt;- 'mean'</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>num_means <span class="ot">&lt;-</span> num_means <span class="sc">%&gt;%</span> </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rows_append</span>(</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">apply</span>(unbal_train <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric), <span class="dv">2</span>,sd) <span class="sc">%&gt;%</span> </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(num_means) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'means'</span>, <span class="st">'sd'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>unbal_trn_norm <span class="ot">&lt;-</span> unbal_train <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">Administrative =</span> (Administrative <span class="sc">-</span> num_means<span class="sc">$</span>Administrative[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>Administrative[<span class="dv">2</span>],</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Administrative_Duration =</span> (Administrative_Duration <span class="sc">-</span> num_means<span class="sc">$</span>Administrative_Duration[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>Administrative_Duration[<span class="dv">2</span>],</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Informational =</span> (Informational <span class="sc">-</span> num_means<span class="sc">$</span>Informational[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>Informational[<span class="dv">2</span>],</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Informational_Duration =</span> (Informational_Duration <span class="sc">-</span> num_means<span class="sc">$</span>Informational_Duration[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>Informational_Duration[<span class="dv">2</span>],</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ProductRelated =</span> (ProductRelated <span class="sc">-</span> num_means<span class="sc">$</span>ProductRelated[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>ProductRelated[<span class="dv">2</span>],</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ProductRelated_Duration =</span> (ProductRelated_Duration <span class="sc">-</span> num_means<span class="sc">$</span>ProductRelated_Duration[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>ProductRelated_Duration[<span class="dv">2</span>],</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">BounceRates =</span> (BounceRates <span class="sc">-</span> num_means<span class="sc">$</span>BounceRates[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>BounceRates[<span class="dv">2</span>],</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ExitRates =</span> (ExitRates <span class="sc">-</span> num_means<span class="sc">$</span>ExitRates[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>ExitRates[<span class="dv">2</span>],</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">PageValues =</span> (PageValues <span class="sc">-</span> num_means<span class="sc">$</span>PageValues[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>PageValues[<span class="dv">2</span>],</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">SpecialDay =</span> (SpecialDay <span class="sc">-</span> num_means<span class="sc">$</span>SpecialDay[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>SpecialDay[<span class="dv">2</span>]</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>unbal_tst_norm <span class="ot">&lt;-</span> unbal_test <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Administrative =</span> (Administrative <span class="sc">-</span> num_means<span class="sc">$</span>Administrative[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>Administrative[<span class="dv">2</span>],</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Administrative_Duration =</span> (Administrative_Duration <span class="sc">-</span> num_means<span class="sc">$</span>Administrative_Duration[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>Administrative_Duration[<span class="dv">2</span>],</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Informational =</span> (Informational <span class="sc">-</span> num_means<span class="sc">$</span>Informational[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>Informational[<span class="dv">2</span>],</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Informational_Duration =</span> (Informational_Duration <span class="sc">-</span> num_means<span class="sc">$</span>Informational_Duration[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>Informational_Duration[<span class="dv">2</span>],</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ProductRelated =</span> (ProductRelated <span class="sc">-</span> num_means<span class="sc">$</span>ProductRelated[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>ProductRelated[<span class="dv">2</span>],</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">ProductRelated_Duration =</span> (ProductRelated_Duration <span class="sc">-</span> num_means<span class="sc">$</span>ProductRelated_Duration[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>ProductRelated_Duration[<span class="dv">2</span>],</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">BounceRates =</span> (BounceRates <span class="sc">-</span> num_means<span class="sc">$</span>BounceRates[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>BounceRates[<span class="dv">2</span>],</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ExitRates =</span> (ExitRates <span class="sc">-</span> num_means<span class="sc">$</span>ExitRates[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>ExitRates[<span class="dv">2</span>],</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">PageValues =</span> (PageValues <span class="sc">-</span> num_means<span class="sc">$</span>PageValues[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>PageValues[<span class="dv">2</span>],</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">SpecialDay =</span> (SpecialDay <span class="sc">-</span> num_means<span class="sc">$</span>SpecialDay[<span class="dv">1</span>])<span class="sc">/</span>num_means<span class="sc">$</span>SpecialDay[<span class="dv">2</span>]</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="balancing-the-datasets" class="level2">
<h2 data-anchor-id="balancing-the-datasets">Balancing the datasets</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>rev_part <span class="ot">&lt;-</span> df2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Revenue <span class="sc">==</span> <span class="st">'1'</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>nrev_part <span class="ot">&lt;-</span> df2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Revenue <span class="sc">==</span> <span class="st">'0'</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">24601</span>)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>sample_nrev_part <span class="ot">=</span> <span class="fu">sample_n</span>(nrev_part, <span class="fu">nrow</span>(rev_part))</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>bal_df1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(rev_part,sample_nrev_part)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="co"># making test and train sets</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">24601</span>)</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>bal_part <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(bal_df1),<span class="fl">0.8</span><span class="sc">*</span><span class="fu">nrow</span>(bal_df1),<span class="at">replace =</span> F)</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>bal_train1 <span class="ot">&lt;-</span> bal_df1[bal_part,]</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>bal_test1 <span class="ot">&lt;-</span> bal_df1[<span class="sc">-</span>bal_part,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="balanced-normalized" class="level2">
<h2 data-anchor-id="balanced-normalized">Balanced, Normalized</h2>
<p>Normalizing the balanced data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>bal_num_means <span class="ot">&lt;-</span> bal_train1 <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span> <span class="fu">colMeans</span>() <span class="sc">%&gt;%</span> <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>bal_num_means <span class="ot">&lt;-</span> bal_num_means <span class="sc">%&gt;%</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rows_append</span>(</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">apply</span>(bal_train1 <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric), <span class="dv">2</span>,sd) <span class="sc">%&gt;%</span> </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(bal_num_means) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'means'</span>, <span class="st">'sd'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>bal_trn_norm <span class="ot">&lt;-</span> bal_train1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">Administrative =</span> (Administrative <span class="sc">-</span> bal_num_means<span class="sc">$</span>Administrative[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>Administrative[<span class="dv">2</span>],</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Administrative_Duration =</span> (Administrative_Duration <span class="sc">-</span> bal_num_means<span class="sc">$</span>Administrative_Duration[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>Administrative_Duration[<span class="dv">2</span>],</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Informational =</span> (Informational <span class="sc">-</span> bal_num_means<span class="sc">$</span>Informational[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>Informational[<span class="dv">2</span>],</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Informational_Duration =</span> (Informational_Duration <span class="sc">-</span> bal_num_means<span class="sc">$</span>Informational_Duration[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>Informational_Duration[<span class="dv">2</span>],</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ProductRelated =</span> (ProductRelated <span class="sc">-</span> bal_num_means<span class="sc">$</span>ProductRelated[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>ProductRelated[<span class="dv">2</span>],</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ProductRelated_Duration =</span> (ProductRelated_Duration <span class="sc">-</span> bal_num_means<span class="sc">$</span>ProductRelated_Duration[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>ProductRelated_Duration[<span class="dv">2</span>],</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">BounceRates =</span> (BounceRates <span class="sc">-</span> bal_num_means<span class="sc">$</span>BounceRates[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>BounceRates[<span class="dv">2</span>],</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ExitRates =</span> (ExitRates <span class="sc">-</span> bal_num_means<span class="sc">$</span>ExitRates[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>ExitRates[<span class="dv">2</span>],</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">PageValues =</span> (PageValues <span class="sc">-</span> bal_num_means<span class="sc">$</span>PageValues[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>PageValues[<span class="dv">2</span>],</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">SpecialDay =</span> (SpecialDay <span class="sc">-</span> bal_num_means<span class="sc">$</span>SpecialDay[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>SpecialDay[<span class="dv">2</span>]</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>bal_tst_norm <span class="ot">&lt;-</span> bal_test1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Administrative =</span> (Administrative <span class="sc">-</span> bal_num_means<span class="sc">$</span>Administrative[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>Administrative[<span class="dv">2</span>],</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Administrative_Duration =</span> (Administrative_Duration <span class="sc">-</span> bal_num_means<span class="sc">$</span>Administrative_Duration[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>Administrative_Duration[<span class="dv">2</span>],</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Informational =</span> (Informational <span class="sc">-</span> bal_num_means<span class="sc">$</span>Informational[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>Informational[<span class="dv">2</span>],</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Informational_Duration =</span> (Informational_Duration <span class="sc">-</span> bal_num_means<span class="sc">$</span>Informational_Duration[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>Informational_Duration[<span class="dv">2</span>],</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ProductRelated =</span> (ProductRelated <span class="sc">-</span> bal_num_means<span class="sc">$</span>ProductRelated[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>ProductRelated[<span class="dv">2</span>],</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">ProductRelated_Duration =</span> (ProductRelated_Duration <span class="sc">-</span> bal_num_means<span class="sc">$</span>ProductRelated_Duration[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>ProductRelated_Duration[<span class="dv">2</span>],</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">BounceRates =</span> (BounceRates <span class="sc">-</span> bal_num_means<span class="sc">$</span>BounceRates[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>BounceRates[<span class="dv">2</span>],</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ExitRates =</span> (ExitRates <span class="sc">-</span> bal_num_means<span class="sc">$</span>ExitRates[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>ExitRates[<span class="dv">2</span>],</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">PageValues =</span> (PageValues <span class="sc">-</span> bal_num_means<span class="sc">$</span>PageValues[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>PageValues[<span class="dv">2</span>],</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">SpecialDay =</span> (SpecialDay <span class="sc">-</span> bal_num_means<span class="sc">$</span>SpecialDay[<span class="dv">1</span>])<span class="sc">/</span>bal_num_means<span class="sc">$</span>SpecialDay[<span class="dv">2</span>]</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="logistic-regression" class="level1">
<h1>Logistic Regression</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>logfit1 <span class="ot">&lt;-</span> <span class="fu">step</span>(<span class="fu">glm</span>(Revenue <span class="sc">~</span> ., <span class="at">data =</span> unbal_train, <span class="at">family =</span> <span class="st">'binomial'</span>), <span class="at">direction =</span> <span class="st">'both'</span>, <span class="at">trace =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logfit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Revenue ~ ProductRelated_Duration + ExitRates + 
    PageValues + Month + TrafficType + VisitorType, family = "binomial", 
    data = unbal_train)

Coefficients:
                               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                  -4.544e+00  1.066e+00  -4.264 2.01e-05 ***
ProductRelated_Duration       1.039e-04  1.549e-05   6.709 1.96e-11 ***
ExitRates                    -1.673e+01  1.866e+00  -8.965  &lt; 2e-16 ***
PageValues                    8.117e-02  2.676e-03  30.329  &lt; 2e-16 ***
MonthMar                      2.179e+00  1.062e+00   2.053  0.04011 *  
MonthMay                      2.225e+00  1.059e+00   2.101  0.03567 *  
MonthJune                     2.484e+00  1.084e+00   2.291  0.02195 *  
MonthJul                      2.588e+00  1.073e+00   2.411  0.01591 *  
MonthAug                      2.673e+00  1.071e+00   2.496  0.01257 *  
MonthSep                      2.758e+00  1.069e+00   2.580  0.00987 ** 
MonthOct                      2.567e+00  1.068e+00   2.405  0.01618 *  
MonthNov                      3.184e+00  1.059e+00   3.008  0.00263 ** 
MonthDec                      2.045e+00  1.062e+00   1.925  0.05423 .  
TrafficType2                  2.109e-01  1.061e-01   1.987  0.04687 *  
TrafficType3                 -2.842e-01  1.411e-01  -2.014  0.04396 *  
TrafficType4                 -4.414e-03  1.599e-01  -0.028  0.97798    
TrafficType5                  4.501e-01  2.264e-01   1.988  0.04683 *  
TrafficType6                 -2.598e-01  2.361e-01  -1.100  0.27116    
TrafficType8                  7.923e-01  1.930e-01   4.105 4.04e-05 ***
TrafficType10                 4.150e-01  1.833e-01   2.264  0.02356 *  
TrafficType11                 3.576e-01  2.363e-01   1.514  0.13012    
TrafficType13                -5.636e-01  2.280e-01  -2.471  0.01346 *  
TrafficType20                 5.381e-01  2.819e-01   1.909  0.05632 .  
TrafficTypeOther             -5.355e-02  3.769e-01  -0.142  0.88703    
VisitorTypeOther             -3.955e-01  5.750e-01  -0.688  0.49159    
VisitorTypeReturning_Visitor -1.994e-01  9.982e-02  -1.998  0.04574 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 8471.3  on 9863  degrees of freedom
Residual deviance: 5645.3  on 9838  degrees of freedom
AIC: 5697.3

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(logfit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            GVIF Df GVIF^(1/(2*Df))
ProductRelated_Duration 1.132368  1        1.064128
ExitRates               1.137086  1        1.066342
PageValues              1.058716  1        1.028939
Month                   1.547322  9        1.024548
TrafficType             1.900713 11        1.029623
VisitorType             1.391888  2        1.086178</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>log_probs_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(logfit1, <span class="at">newdata =</span> unbal_test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>log_preds_test <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(log_probs_test <span class="sc">&gt;=</span> <span class="fl">0.135</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>resp_preds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">actual =</span> unbal_test<span class="sc">$</span>Revenue,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">log_unbal =</span> log_preds_test</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(resp_preds<span class="sc">$</span>log_unbal, resp_preds<span class="sc">$</span>actual, <span class="at">positive =</span> <span class="st">'1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 1664   73
         1  412  317
                                          
               Accuracy : 0.8033          
                 95% CI : (0.7871, 0.8188)
    No Information Rate : 0.8418          
    P-Value [Acc &gt; NIR] : 1               
                                          
                  Kappa : 0.4541          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.8128          
            Specificity : 0.8015          
         Pos Pred Value : 0.4348          
         Neg Pred Value : 0.9580          
             Prevalence : 0.1582          
         Detection Rate : 0.1285          
   Detection Prevalence : 0.2956          
      Balanced Accuracy : 0.8072          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
<p>Sensitivity, Specificity, and Accuracy are pretty good, but precision is very bad. Basically, of the records that are said to be positive, I’m more often incorrect than I am correct. This is largely due to the imbalanced nature of the data, but still seems like there is room for improvement.</p>
<section id="unbalanced-standardized-logistic" class="level3">
<h3 data-anchor-id="unbalanced-standardized-logistic">Unbalanced, Standardized, Logistic</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>logfit2 <span class="ot">&lt;-</span> <span class="fu">step</span>(<span class="fu">glm</span>(Revenue <span class="sc">~</span> ., <span class="at">data =</span> unbal_trn_norm, <span class="at">family =</span> <span class="st">'binomial'</span>), <span class="at">direction =</span> <span class="st">'both'</span>, <span class="at">trace =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logfit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Revenue ~ ProductRelated_Duration + ExitRates + 
    PageValues + Month + TrafficType + VisitorType, family = "binomial", 
    data = unbal_trn_norm)

Coefficients:
                              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                  -4.654030   1.063672  -4.375 1.21e-05 ***
ProductRelated_Duration       0.195716   0.029174   6.709 1.96e-11 ***
ExitRates                    -0.814037   0.090805  -8.965  &lt; 2e-16 ***
PageValues                    1.559736   0.051427  30.329  &lt; 2e-16 ***
MonthMar                      2.179071   1.061588   2.053  0.04011 *  
MonthMay                      2.224937   1.059170   2.101  0.03567 *  
MonthJune                     2.484200   1.084256   2.291  0.02195 *  
MonthJul                      2.587623   1.073236   2.411  0.01591 *  
MonthAug                      2.673050   1.071032   2.496  0.01257 *  
MonthSep                      2.758185   1.068884   2.580  0.00987 ** 
MonthOct                      2.567294   1.067600   2.405  0.01618 *  
MonthNov                      3.184302   1.058597   3.008  0.00263 ** 
MonthDec                      2.044670   1.062186   1.925  0.05423 .  
TrafficType2                  0.210914   0.106121   1.987  0.04687 *  
TrafficType3                 -0.284195   0.141076  -2.014  0.04396 *  
TrafficType4                 -0.004414   0.159915  -0.028  0.97798    
TrafficType5                  0.450115   0.226440   1.988  0.04683 *  
TrafficType6                 -0.259806   0.236103  -1.100  0.27116    
TrafficType8                  0.792262   0.192979   4.105 4.04e-05 ***
TrafficType10                 0.415015   0.183295   2.264  0.02356 *  
TrafficType11                 0.357604   0.236256   1.514  0.13012    
TrafficType13                -0.563584   0.228041  -2.471  0.01346 *  
TrafficType20                 0.538115   0.281950   1.909  0.05632 .  
TrafficTypeOther             -0.053547   0.376919  -0.142  0.88703    
VisitorTypeOther             -0.395473   0.574996  -0.688  0.49159    
VisitorTypeReturning_Visitor -0.199427   0.099824  -1.998  0.04574 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 8471.3  on 9863  degrees of freedom
Residual deviance: 5645.3  on 9838  degrees of freedom
AIC: 5697.3

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(logfit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            GVIF Df GVIF^(1/(2*Df))
ProductRelated_Duration 1.132368  1        1.064128
ExitRates               1.137086  1        1.066342
PageValues              1.058716  1        1.028939
Month                   1.547322  9        1.024548
TrafficType             1.900713 11        1.029623
VisitorType             1.391888  2        1.086178</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>norm_log_probs_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(logfit2, <span class="at">newdata =</span> unbal_tst_norm, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>norm_log_preds_test <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(norm_log_probs_test <span class="sc">&gt;=</span> <span class="fl">0.14</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>resp_preds<span class="sc">$</span>log_unbal_norm <span class="ot">&lt;-</span> norm_log_preds_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(resp_preds<span class="sc">$</span>log_unbal_norm, resp_preds<span class="sc">$</span>actual, <span class="at">positive =</span> <span class="st">'1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 1685   73
         1  391  317
                                          
               Accuracy : 0.8118          
                 95% CI : (0.7958, 0.8271)
    No Information Rate : 0.8418          
    P-Value [Acc &gt; NIR] : 1               
                                          
                  Kappa : 0.4691          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.8128          
            Specificity : 0.8117          
         Pos Pred Value : 0.4477          
         Neg Pred Value : 0.9585          
             Prevalence : 0.1582          
         Detection Rate : 0.1285          
   Detection Prevalence : 0.2871          
      Balanced Accuracy : 0.8122          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
<p>still the same issues after normalizing, which is generally expected. We did, however, marginally improve each of the classification metrics. However we lost some interpretability to do so, so it may not be worth doing.</p>
</section>
<section id="balanced-unstandardized-logistic" class="level3">
<h3 data-anchor-id="balanced-unstandardized-logistic">Balanced, unstandardized, Logistic</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>logfit3 <span class="ot">&lt;-</span> <span class="fu">step</span>(<span class="fu">glm</span>(Revenue <span class="sc">~</span> ., <span class="at">data =</span> bal_train1, <span class="at">family =</span> <span class="st">'binomial'</span>), <span class="at">direction =</span> <span class="st">'both'</span>, <span class="at">trace =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logfit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Revenue ~ Administrative + Informational + ProductRelated + 
    ExitRates + PageValues + Month + TrafficType, family = "binomial", 
    data = bal_train1)

Coefficients:
                   Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       -3.189361   1.055299  -3.022  0.00251 ** 
Administrative     0.023478   0.015768   1.489  0.13649    
Informational      0.074426   0.038310   1.943  0.05205 .  
ProductRelated     0.005329   0.001220   4.369 1.25e-05 ***
ExitRates        -13.975468   2.281118  -6.127 8.98e-10 ***
PageValues         0.127392   0.006483  19.650  &lt; 2e-16 ***
MonthMar           1.488232   1.054026   1.412  0.15796    
MonthMay           1.410251   1.048205   1.345  0.17850    
MonthJune          2.077860   1.100981   1.887  0.05912 .  
MonthJul           2.620688   1.070139   2.449  0.01433 *  
MonthAug           2.398472   1.069452   2.243  0.02492 *  
MonthSep           2.394214   1.068930   2.240  0.02510 *  
MonthOct           2.303218   1.067713   2.157  0.03099 *  
MonthNov           2.881357   1.048867   2.747  0.00601 ** 
MonthDec           1.700780   1.054176   1.613  0.10666    
TrafficType2       0.270132   0.147123   1.836  0.06634 .  
TrafficType3      -0.118649   0.191630  -0.619  0.53581    
TrafficType4       0.168782   0.219716   0.768  0.44238    
TrafficType5       0.429750   0.332320   1.293  0.19595    
TrafficType6       0.118013   0.306450   0.385  0.70017    
TrafficType8       0.519182   0.275603   1.884  0.05959 .  
TrafficType10      0.357699   0.273299   1.309  0.19060    
TrafficType11      0.605916   0.333553   1.817  0.06929 .  
TrafficType13     -0.736725   0.289490  -2.545  0.01093 *  
TrafficType20      0.386512   0.478696   0.807  0.41942    
TrafficTypeOther  -0.035313   0.493544  -0.072  0.94296    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 4229.5  on 3051  degrees of freedom
Residual deviance: 2485.7  on 3026  degrees of freedom
AIC: 2537.7

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(logfit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   GVIF Df GVIF^(1/(2*Df))
Administrative 1.296233  1        1.138522
Informational  1.189551  1        1.090665
ProductRelated 1.350909  1        1.162286
ExitRates      1.177768  1        1.085250
PageValues     1.122590  1        1.059524
Month          1.796772  9        1.033091
TrafficType    1.711386 11        1.024724</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>bal_log_probs_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(logfit3, <span class="at">newdata =</span> bal_test1, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>bal_log_preds_test <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(bal_log_probs_test <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>resp_preds_bal <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">actuals =</span> bal_test1<span class="sc">$</span>Revenue,</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">log_bal =</span> bal_log_preds_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(resp_preds_bal<span class="sc">$</span>log_bal, resp_preds_bal<span class="sc">$</span>actual, <span class="at">positive =</span> <span class="st">'1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 303  90
         1  45 326
                                          
               Accuracy : 0.8233          
                 95% CI : (0.7944, 0.8497)
    No Information Rate : 0.5445          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6475          
                                          
 Mcnemar's Test P-Value : 0.0001525       
                                          
            Sensitivity : 0.7837          
            Specificity : 0.8707          
         Pos Pred Value : 0.8787          
         Neg Pred Value : 0.7710          
             Prevalence : 0.5445          
         Detection Rate : 0.4267          
   Detection Prevalence : 0.4856          
      Balanced Accuracy : 0.8272          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
</section>
<section id="logistic-models-interpretations" class="level2">
<h2 data-anchor-id="logistic-models-interpretations">Logistic Models: Interpretations</h2>
<section id="linearity-assumption" class="level4">
<h4 data-anchor-id="linearity-assumption">Linearity Assumption</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>linlog3 <span class="ot">&lt;-</span> bal_train1 <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span> </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">probabilities =</span> <span class="fu">predict</span>(logfit3, <span class="at">type =</span> <span class="st">'response'</span>),</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">logit =</span> <span class="fu">log</span>(probabilities<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>probabilities))</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>logit_scatter <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">colnames</span>(linlog3),</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>       <span class="cf">function</span>(col) {</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(linlog3,</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> .data<span class="sc">$</span>logit, <span class="at">y =</span> .data[[col]])) <span class="sc">+</span> </span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'loess'</span>) <span class="sc">+</span> </span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ggtitle</span>(col)</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>logit_scatter[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">geom_jitter</span>() <span class="sc">+</span> logit_scatter[[<span class="dv">3</span>]] <span class="sc">+</span> <span class="fu">geom_jitter</span>() <span class="sc">+</span> logit_scatter[[<span class="dv">5</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>logit_scatter[[<span class="dv">8</span>]] <span class="sc">+</span> logit_scatter[[<span class="dv">9</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-48-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggplot(linlog3, aes(logit, predictor.value))+</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_point(size = 0.5, alpha = 0.5) +</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_smooth(method = "loess") + </span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  theme_bw() + </span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  facet_wrap(~predictors, scales = "free_y")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Almost all of the numeric variables do not have a linear relationship with the logsitic model output, with the exception of Page Value.</p>
</section>
<section id="outliers-influential-points" class="level4">
<h4 data-anchor-id="outliers-influential-points">Outliers/ Influential points</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(logfit1, <span class="at">which =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(logfit2, <span class="at">which =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(logfit3, <span class="at">which =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">HosmerLemeshowTest</span>(<span class="fu">fitted</span>(logfit3), bal_train1<span class="sc">$</span>Revenue)<span class="sc">$</span>C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in Ops.factor(1, obs): '-' not meaningful for factors
Warning in Ops.factor(1, obs): '-' not meaningful for factors</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hosmer-Lemeshow C statistic

data:  fitted(logfit3) and bal_train1$Revenue
X-squared = 3052, df = 8, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>log3data <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">augment</span>(logfit3) <span class="sc">%&gt;%</span> </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(log3data, <span class="fu">aes</span>(index, .std.resid)) <span class="sc">+</span> </span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Revenue), <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">abs</span>(log3data<span class="sc">$</span>.std.resid)<span class="sc">&gt;</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
</div>
</section>
<section id="multicollinearity" class="level4">
<h4 data-anchor-id="multicollinearity">Multicollinearity</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(logfit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   GVIF Df GVIF^(1/(2*Df))
Administrative 1.296233  1        1.138522
Informational  1.189551  1        1.090665
ProductRelated 1.350909  1        1.162286
ExitRates      1.177768  1        1.085250
PageValues     1.122590  1        1.059524
Month          1.796772  9        1.033091
TrafficType    1.711386 11        1.024724</code></pre>
</div>
</div>
</section>
<section id="logistic-assumptions-conclusions" class="level4">
<h4 data-anchor-id="logistic-assumptions-conclusions">Logistic Assumptions Conclusions</h4>
<p>The logistic models violate several of the assumptions of a Logistic model, namely that there are several influential outliers and that few of the numeric variables have a linear relationship with the Revenue outcome in logit scale. There may still be a chance to rectify some of these issues, by removing outlier observations or transforming the data.</p>
</section>
</section>
</section>
<section id="svm" class="level1">
<h1>SVM</h1>
<section id="unbalanced-normalized" class="level2">
<h2 data-anchor-id="unbalanced-normalized">Unbalanced, Normalized</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># decreased the scope of the tuning parameters to make the model run faster. Very slow otherwise.</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="co">#form1 &lt;- Revenue ~ .</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(24601)</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co">#svmtune1 &lt;- tune.svm(form1, data = unbal_train, kernel = 'linear', cost = seq(0.1, 1, by = 0.1))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">#svmtune1$best.parameters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>best params so far: 0.05 and 0.5</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">#svmfit1 &lt;- svm(form1, data = unbal_train, kernel = 'linear', cost = svmtune1$best.parameters$cost)</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(svmfit1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">#resp_preds$svm_unbal &lt;- predict(svmfit1, newdata = unbal_test, type = 'response')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">#caret::confusionMatrix(resp_preds$svm_unbal, resp_preds$actual, positive = '1')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Unbalanced data leads to the SVM model performing pretty terribly. It is not bad in accuracy, but favors incidents where a revenue transaction is not performed. Since we do not have the ability to manipulate the probability threshold like was done for logistic regression, the only option to combat this is to use balanced data.</p>
</section>
<section id="balanced-variables-selected" class="level2">
<h2 data-anchor-id="balanced-variables-selected">Balanced, Variables Selected</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">24601</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>form1 <span class="ot">&lt;-</span> Revenue <span class="sc">~</span> PageValues <span class="sc">+</span> Month <span class="sc">+</span> TrafficType <span class="sc">+</span> VisitorType <span class="sc">+</span> Weekend <span class="sc">+</span> Browser <span class="sc">+</span> ProductRelated_Duration <span class="sc">+</span> Administrative_Duration <span class="sc">+</span> Informational_Duration <span class="sc">+</span> ExitRates</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>bal_svmtune1 <span class="ot">&lt;-</span> <span class="fu">tune.svm</span>(form1, <span class="at">data =</span> bal_train1, <span class="at">kernel =</span> <span class="st">'linear'</span>, <span class="at">cost =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>bal_svmtune1<span class="sc">$</span>best.parameters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   cost
14  1.4</code></pre>
</div>
</div>
<p>best cost parameter is 1.9</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>bal_svmfit1 <span class="ot">&lt;-</span> <span class="fu">svm</span>(form1, <span class="at">data =</span> bal_train1, <span class="at">kernel =</span> <span class="st">'linear'</span>, <span class="at">cost =</span> bal_svmtune1<span class="sc">$</span>best.parameters<span class="sc">$</span>cost)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bal_svmfit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm(formula = form1, data = bal_train1, kernel = "linear", cost = bal_svmtune1$best.parameters$cost)


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  linear 
       cost:  1.4 

Number of Support Vectors:  1323

 ( 656 667 )


Number of Classes:  2 

Levels: 
 0 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>resp_preds_bal<span class="sc">$</span>svm_bal <span class="ot">&lt;-</span> <span class="fu">predict</span>(bal_svmfit1, <span class="at">newdata =</span> bal_test1, <span class="at">type =</span> <span class="st">'response'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(resp_preds_bal<span class="sc">$</span>svm_bal, resp_preds_bal<span class="sc">$</span>actual, <span class="at">positive =</span> <span class="st">'1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 314  96
         1  34 320
                                          
               Accuracy : 0.8298          
                 95% CI : (0.8013, 0.8558)
    No Information Rate : 0.5445          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6619          
                                          
 Mcnemar's Test P-Value : 8.793e-08       
                                          
            Sensitivity : 0.7692          
            Specificity : 0.9023          
         Pos Pred Value : 0.9040          
         Neg Pred Value : 0.7659          
             Prevalence : 0.5445          
         Detection Rate : 0.4188          
   Detection Prevalence : 0.4634          
      Balanced Accuracy : 0.8358          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>svm_imp <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">t</span>(bal_svmfit1<span class="sc">$</span>coefs) <span class="sc">%*%</span> bal_svmfit1<span class="sc">$</span>SV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>svm_imp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">colnames</span>(svm_imp), <span class="at">Importance =</span> <span class="fu">as.vector</span>(svm_imp))</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>svm_imp_df2 <span class="ot">&lt;-</span> svm_imp_df[<span class="fu">order</span>(<span class="sc">-</span>svm_imp_df<span class="sc">$</span>Importance),]</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(svm_imp_df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Variable  Importance
1                    PageValues 3.377157743
36                    Browser12 1.302517670
30                     Browser6 0.686653193
35                    Browser11 0.647766297
31                     Browser7 0.603925955
21                TrafficType20 0.551031944
37                    Browser13 0.525159444
10                     MonthNov 0.516928291
23             VisitorTypeOther 0.512831197
20                TrafficType13 0.379844904
27                     Browser3 0.350682401
19                TrafficType11 0.281648579
38      ProductRelated_Duration 0.242261827
4                      MonthMay 0.188485207
41                    ExitRates 0.175849536
17                 TrafficType8 0.159264800
2                      MonthFeb 0.145464505
11                     MonthDec 0.137083308
15                 TrafficType5 0.128611868
18                TrafficType10 0.116888117
3                      MonthMar 0.104626971
28                     Browser4 0.098697657
34                    Browser10 0.092106531
6                      MonthJul 0.088793246
12                 TrafficType2 0.082727574
5                     MonthJune 0.067890453
40       Informational_Duration 0.063319798
29                     Browser5 0.062568739
26                     Browser2 0.059018415
7                      MonthAug 0.053973689
25                  WeekendTRUE 0.052142329
13                 TrafficType3 0.048171876
24 VisitorTypeReturning_Visitor 0.045816177
32                     Browser8 0.040772502
14                 TrafficType4 0.034647319
8                      MonthSep 0.023999622
39      Administrative_Duration 0.022263640
22             TrafficTypeOther 0.020827229
9                      MonthOct 0.007854841
16                 TrafficType6 0.001861453
33                     Browser9 0.000000000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>svm_imp_df2 <span class="sc">%&gt;%</span> </span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(Importance &gt;= 1.295415e-01) %&gt;% </span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">reorder</span>(Variable, Importance), <span class="at">x =</span> Importance)) <span class="sc">+</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>)) <span class="sc">+</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SVM Variable Importance"</span>, <span class="at">x =</span> <span class="st">"Variable"</span>, <span class="at">y =</span> <span class="st">"Importance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>svm_imp_df2 <span class="sc">%&gt;%</span> <span class="co">#filter(Variable != 'PageValues') %&gt;% </span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">reorder</span>(Variable, Importance), <span class="at">x =</span> Importance)) <span class="sc">+</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SVM Variable Importance"</span>, <span class="at">x =</span> <span class="st">"Variable"</span>, <span class="at">y =</span> <span class="st">"Importance"</span>) <span class="sc">+</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="random-forest" class="level1">
<h1>Random Forest</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">24601</span>)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>rffit1 <span class="ot">&lt;-</span> <span class="fu">rfsrc</span>(Revenue <span class="sc">~</span> .,</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> unbal_train, </span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">importance =</span> <span class="cn">TRUE</span>, </span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">ntree =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>rffit1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Sample size: 9864
           Frequency of class labels: 8346, 1518
                     Number of trees: 1000
           Forest terminal node size: 1
       Average no. of terminal nodes: 708.525
No. of variables tried at each split: 5
              Total no. of variables: 17
       Resampling used to grow trees: swor
    Resample size used to grow trees: 6234
                            Analysis: RF-C
                              Family: class
                      Splitting rule: gini *random*
       Number of random split points: 10
                    Imbalanced ratio: 5.498
                   (OOB) Brier score: 0.06767083
        (OOB) Normalized Brier score: 0.27068331
                           (OOB) AUC: 0.93200703
                      (OOB) Log-loss: 0.22162409
                        (OOB) PR-AUC: 0.75650861
                        (OOB) G-mean: 0.75806944
   (OOB) Requested performance error: 0.09347121, 0.03714354, 0.40316206

Confusion matrix:

          predicted
  observed    0   1 class.error
         0 8037 309      0.0370
         1  612 906      0.4032

      (OOB) Misclassification rate: 0.09336983</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>rffit1<span class="sc">$</span>importance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                  all            0            1
Administrative           0.0402520978  0.109926588  0.099294287
Administrative_Duration  0.0202386004  0.067957046 -0.019823043
Informational            0.0515155661  0.164933851 -0.006213727
Informational_Duration   0.0243660397  0.075265726  0.012158850
ProductRelated           0.0396467308  0.122970823  0.016975831
ProductRelated_Duration  0.0310703857  0.100621374 -0.010045824
BounceRates              0.0188502005  0.032937915  0.148448988
ExitRates                0.0229955103  0.037654033  0.194989268
PageValues               0.5921854784  1.691073546  1.055062234
SpecialDay              -0.0001261306 -0.004230827  0.021058626
Month                    0.0231994095  0.039836215  0.186555073
OperatingSystems         0.0155565968  0.047894002  0.008631172
Browser                  0.0208489233  0.074575244 -0.045537488
Region                   0.0087702225  0.023717384  0.022920953
TrafficType              0.0151190018  0.047281689  0.004351400
VisitorType              0.0193762853  0.077480477 -0.087260786
Weekend                  0.0018836296  0.005784410  0.001128141</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">importance =</span> rffit1<span class="sc">$</span>importance[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable,importance), <span class="at">y =</span> importance)) <span class="sc">+</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Variable importance"</span>, <span class="at">title =</span> <span class="st">'Random Forest Variable Importance:</span><span class="sc">\n</span><span class="st">Unbalanced Response'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">importance =</span> rffit1<span class="sc">$</span>importance[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">'PageValues'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable,importance), <span class="at">y =</span> importance)) <span class="sc">+</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Variable importance"</span>, <span class="at">title =</span> <span class="st">'Random Forest Variable Importance:</span><span class="sc">\n</span><span class="st">Unbalanced Response'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>rf_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(rffit1, <span class="at">newdata =</span> unbal_test)<span class="sc">$</span>predicted[,<span class="dv">2</span>]</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>rf_preds <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(rf_probs <span class="sc">&gt;=</span> <span class="fl">0.165</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>resp_preds<span class="sc">$</span>rf <span class="ot">&lt;-</span> rf_preds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(resp_preds<span class="sc">$</span>rf, resp_preds<span class="sc">$</span>actual, <span class="at">positive =</span> <span class="st">'1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 1768   57
         1  308  333
                                          
               Accuracy : 0.852           
                 95% CI : (0.8374, 0.8658)
    No Information Rate : 0.8418          
    P-Value [Acc &gt; NIR] : 0.0873          
                                          
                  Kappa : 0.5593          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.8538          
            Specificity : 0.8516          
         Pos Pred Value : 0.5195          
         Neg Pred Value : 0.9688          
             Prevalence : 0.1582          
         Detection Rate : 0.1350          
   Detection Prevalence : 0.2599          
      Balanced Accuracy : 0.8527          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
<p>I don’t really like how I have to adjust the threshold to get the random forest to work. Going to try some different methods.</p>
<section id="balanced-random-forest" class="level2">
<h2 data-anchor-id="balanced-random-forest">Balanced Random Forest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">24601</span>)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>rffit2 <span class="ot">&lt;-</span> <span class="fu">rfsrc</span>(Revenue <span class="sc">~</span> .,</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> bal_train1, </span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">importance =</span> <span class="cn">TRUE</span>, </span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">ntree =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>rffit2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Sample size: 3052
           Frequency of class labels: 1560, 1492
                     Number of trees: 1000
           Forest terminal node size: 1
       Average no. of terminal nodes: 336.597
No. of variables tried at each split: 5
              Total no. of variables: 17
       Resampling used to grow trees: swor
    Resample size used to grow trees: 1929
                            Analysis: RF-C
                              Family: class
                      Splitting rule: gini *random*
       Number of random split points: 10
                    Imbalanced ratio: 1.0456
                   (OOB) Brier score: 0.10461445
        (OOB) Normalized Brier score: 0.41845779
                           (OOB) AUC: 0.93172862
                      (OOB) Log-loss: 0.33351603
                        (OOB) PR-AUC: 0.92340393
                        (OOB) G-mean: 0.85373393
   (OOB) Requested performance error: 0.14613368, 0.14102564, 0.15147453

Confusion matrix:

          predicted
  observed    0    1 class.error
         0 1340  220      0.1410
         1  226 1266      0.1515

      (OOB) Misclassification rate: 0.1461337</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>rffit2<span class="sc">$</span>importance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                all             0             1
Administrative          0.038215684  0.1497145992  0.0537644080
Administrative_Duration 0.019980648  0.0932057019  0.0124982663
Informational           0.052569678  0.2669840652  0.0101662283
Informational_Duration  0.030322579  0.1399392395  0.0205328661
ProductRelated          0.040181630  0.1853833357  0.0272921326
ProductRelated_Duration 0.028040526  0.1484948573 -0.0009473904
BounceRates             0.020972249  0.0233319190  0.0910223593
ExitRates               0.052599050  0.0181218789  0.2704981924
PageValues              0.536484563  1.7631194137  1.1088294260
SpecialDay              0.012478900 -0.0684100927  0.1401955675
Month                   0.069626223  0.1502199208  0.2260801556
OperatingSystems        0.011544456  0.0418197204  0.0198041042
Browser                 0.023431681  0.0866016711  0.0384057513
Region                  0.010997212  0.0296571517  0.0295148563
TrafficType             0.020831402  0.0737421070  0.0375312370
VisitorType             0.017105228  0.1038871555 -0.0144841425
Weekend                 0.000440454 -0.0006621456  0.0031154571</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>rf_probs_bal <span class="ot">&lt;-</span> <span class="fu">predict</span>(rffit2, <span class="at">newdata =</span> bal_test1)<span class="sc">$</span>predicted[,<span class="dv">2</span>]</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>rf_preds_bal <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(rf_probs_bal <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>resp_preds_bal<span class="sc">$</span>rf <span class="ot">&lt;-</span> rf_preds_bal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(resp_preds_bal<span class="sc">$</span>rf, resp_preds_bal<span class="sc">$</span>actual, <span class="at">positive =</span> <span class="st">'1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 298  53
         1  50 363
                                          
               Accuracy : 0.8652          
                 95% CI : (0.8389, 0.8886)
    No Information Rate : 0.5445          
    P-Value [Acc &gt; NIR] : &lt;2e-16          
                                          
                  Kappa : 0.7284          
                                          
 Mcnemar's Test P-Value : 0.8438          
                                          
            Sensitivity : 0.8726          
            Specificity : 0.8563          
         Pos Pred Value : 0.8789          
         Neg Pred Value : 0.8490          
             Prevalence : 0.5445          
         Detection Rate : 0.4751          
   Detection Prevalence : 0.5406          
      Balanced Accuracy : 0.8645          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">importance =</span> rffit2<span class="sc">$</span>importance[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable,importance), <span class="at">y =</span> importance)) <span class="sc">+</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Variable importance"</span>, <span class="at">title =</span> <span class="st">'Random Forest Variable Importance: Balanced Response'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">importance =</span> rffit2<span class="sc">$</span>importance[,<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">'PageValues'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable,importance), <span class="at">y =</span> importance)) <span class="sc">+</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Variable importance"</span>, <span class="at">title =</span> <span class="st">'Random Forest Variable Importance: Balanced Response'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_project_sandbox_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The problem with balanced:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>bal_train1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Month) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Rev =</span> <span class="fu">sum</span>(<span class="fu">ifelse</span>(Revenue <span class="sc">==</span> <span class="st">'0'</span>, <span class="dv">0</span>, <span class="dv">1</span>)), <span class="at">NonRev=</span><span class="fu">n</span>() <span class="sc">-</span> Rev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   Month   Rev NonRev
   &lt;fct&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 Feb       2     20
 2 Mar     146    275
 3 May     300    444
 4 June     22     38
 5 Jul      49     56
 6 Aug      55     57
 7 Sep      64     53
 8 Oct      89     58
 9 Nov     584    325
10 Dec     181    234</code></pre>
</div>
</div>
<p>Categorical variable distributions change, and it’s difficult to tell if it is in an even way based on the original distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>sandbox_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(rffit2, <span class="at">newdata =</span> unbal_test)<span class="sc">$</span>predicted[,<span class="dv">2</span>]</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>sandbox_test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">actuals =</span> unbal_test<span class="sc">$</span>Revenue,</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">preds =</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(sandbox_probs <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(sandbox_test<span class="sc">$</span>preds, sandbox_test<span class="sc">$</span>actuals, <span class="at">positive =</span> <span class="st">'1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    0    1
         0 1811   12
         1  265  378
                                          
               Accuracy : 0.8877          
                 95% CI : (0.8745, 0.8999)
    No Information Rate : 0.8418          
    P-Value [Acc &gt; NIR] : 4.517e-11       
                                          
                  Kappa : 0.6661          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9692          
            Specificity : 0.8724          
         Pos Pred Value : 0.5879          
         Neg Pred Value : 0.9934          
             Prevalence : 0.1582          
         Detection Rate : 0.1533          
   Detection Prevalence : 0.2607          
      Balanced Accuracy : 0.9208          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>


</section>
</section>


<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>